@model IEnumerable<project6_myStore.Models.cart_item>



<style>
    .table-content {
        max-height: 585px; /* Set the desired maximum height */
        overflow-y: auto; /* Enable vertical scrolling */
    }
</style>
@*<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-1BmE4kWBq78iYhFldvKuhfTAU6auU8tT94WrHftjDbrCEXSU1oBoqyl2QvZ6jIW3" crossorigin="anonymous">*@


<!-- breadcrumb-area start -->
<div class="breadcrumb-area">
    <div class="container">
        <div class="row">
            <div class="col-md-12">
                <div class="breadcrumb-list">
                    <h1>Shopping Cart</h1>
                    <ul>
                        <li><a href="index.html">home</a> <span class="divider">|</span></li>
                        <li><a href="cart.html">Shopping cart</a> <span class="divider">|</span></li>
                        <li>Shopping cart</li>
                    </ul>
                </div>
            </div>
        </div>
    </div>
</div>
<!-- breadcrumb-area end -->
<!-- cart-main-area start -->
<div class="cart-main-area">
    <div class="container">
        <div class="row">
            <div class="col-md-12 col-sm-12 col-xs-12">
                <form action="#">
                    <div class="table-content position-relative">
                        <table>
                            <thead class="bg-light sticky-top top-0">
                                <tr>
                                    <th class="product-thumbnail">Image</th>
                                    <th class="product-name">Product</th>
                                    <th class="product-price">Price</th>
                                    <th class="product-quantity">Quantity</th>
                                    <th class="product-subtotal">Total</th>
                                    <th class="product-remove">Remove</th>
                                </tr>
                            </thead>
                            <tbody>
                                @foreach (var item in Model)
                                {
                                    <tr>
                                        <td class="product-thumbnail"><a href="#"><img src="~/myContant/img/product/@item.product.img_1" alt="" width="100.125em" height="8.125em" /></a></td>
                                        <td class="product-name"><a href="#">@item.product.name</a></td>
                                        <td class="product-price"><span class="amount">$@item.product.price</span></td>
                                        <td class="product-quantity">
                                          
                                            <form></form>
                                            @using (Html.BeginForm("updateCartItem", "store", new { id = item.id }))
                                            {

                                                <input name="quantity" type="number" value="@item.quantity" />
                                                <button type="submit" style="color:red; background:none; border:none; cursor:pointer;">Update</button>

                                            }
                                        </td>
                                        <td class="product-subtotal">$@(@item.product.price * @item.quantity)</td>
                                        <td class="product-remove">
                                            <a href="@Url.Action("DeleteCartItem", "store", new { id = item.id })"
                                               onclick="confirmDeletion(event, this)">
                                                <i class="fa fa-times"></i>
                                            </a>
                                        </td>
                                    </tr>
                                }

                            </tbody>
                        </table>
                    </div>
                    <br />
                    <br />
                    <div class="row">
                        <div class="col-md-8 col-sm-7 col-xs-12">
                            <div class="buttons-cart">
                                <a href="#">Continue Shopping</a>
                            </div>
                           
                        </div>
                        <div class="col-md-4 col-sm-5 col-xs-12">
                            <div class="cart_totals">
                                <h2>Cart Totals</h2>
                                <table>
                                    <tbody>
                                        @{

                                            decimal Subtotal = 0;
                                            foreach (var item in Model)
                                            {
                                                Subtotal += item.product.price * Convert.ToDecimal(item.quantity);
                                            }

                                            <tr class="cart-subtotal">
                                                <th>Subtotal</th>
                                                <td><span class="amount">$@Subtotal</span></td>
                                            </tr>

                                            <tr class="shipping">
                                                <th>Shipping&nbsp;</th>
                                                <td>
                                                    <ul id="shipping_method">
                                                        <li>
                                                            <input name="shipping" type="radio" value="7" />
                                                            <label>
                                                                Flat Rate: <span class="amount">$7.00</span>
                                                            </label>
                                                        </li>
                                                        <li>
                                                            <input name="shipping" type="radio" value="0" />
                                                            <label>
                                                                Free Shipping &nbsp;&nbsp;
                                                            </label>
                                                        </li>
                                                        <li></li>
                                                    </ul>
                                                    <p><a class="shipping-calculator-button" href="#">Calculate Shipping</a></p>
                                                </td>
                                            </tr>
                                            <tr class="order-total">
                                                <th>Total&nbsp;</th>
                                                <td>

                                                    <strong><span class="amount"><span id="selectedShippingValue">$@Subtotal</span></span></strong>
                                                </td>

                                            </tr>
                                        }
                                    </tbody>
                                </table>
                                <div class="wc-proceed-to-checkout">
                                    <a href="@Url.Action("CheckOut", "store")">Proceed to Checkout</a>
                                </div>
                            </div>
                        </div>
                    </div>
                </form>
            </div>
        </div>
    </div>
</div>
<!-- cart-main-area end -->
<!-- brand-area start -->
<div class="brand-area">
    <div class="container">
        <div class="brand-inner-container pad-60">
            <div class="row">
                <div class="brand-curosel">
                    <div class="col-md-12">
                        <div class="single-brand">
                            <a href="#"><img src="img/brand/1.png" alt="" /></a>
                        </div>
                    </div>
                    <div class="col-md-12">
                        <div class="single-brand">
                            <a href="#"><img src="img/brand/1.png" alt="" /></a>
                        </div>
                    </div>
                    <div class="col-md-12">
                        <div class="single-brand">
                            <a href="#"><img src="img/brand/1.png" alt="" /></a>
                        </div>
                    </div>
                    <div class="col-md-12">
                        <div class="single-brand">
                            <a href="#"><img src="img/brand/1.png" alt="" /></a>
                        </div>
                    </div>
                    <div class="col-md-12">
                        <div class="single-brand">
                            <a href="#"><img src="img/brand/1.png" alt="" /></a>
                        </div>
                    </div>
                    <div class="col-md-12">
                        <div class="single-brand">
                            <a href="#"><img src="img/brand/1.png" alt="" /></a>
                        </div>
                    </div>
                    <div class="col-md-12">
                        <div class="single-brand">
                            <a href="#"><img src="img/brand/1.png" alt="" /></a>
                        </div>
                    </div>
                    <div class="col-md-12">
                        <div class="single-brand">
                            <a href="#"><img src="img/brand/1.png" alt="" /></a>
                        </div>
                    </div>
                    <div class="col-md-12">
                        <div class="single-brand">
                            <a href="#"><img src="img/brand/1.png" alt="" /></a>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>
<!-- brand-area end -->
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/sweetalert2@11/dist/sweetalert2.min.css">
<script src="https://cdn.jsdelivr.net/npm/sweetalert2@11"></script>
<script>
        // Assuming Subtotal is coming from your backend model
        var subtotal = @Subtotal;

        function updateTotal() {
            // Get the selected shipping value
            var selectedShipping = parseFloat(document.querySelector('input[name="shipping"]:checked').value);

            // Calculate the total
            var total = subtotal + selectedShipping;

            // Display the total
            document.getElementById('selectedShippingValue').innerText = "$" + total.toFixed(2);
        }

        // Attach the event listener to the radio buttons to call updateTotal when a change occurs
        document.addEventListener('DOMContentLoaded', function () {
            var radios = document.getElementsByName('shipping');
            for (var i = 0; i < radios.length; i++) {
                radios[i].addEventListener('change', updateTotal);
            }

            // Call the function once to initialize the total value with the default selection
            updateTotal();
        });

    function confirmDeletion(event, element) {
        event.preventDefault(); // Prevent the default action (navigation)

        // Show the SweetAlert confirmation dialog
        Swal.fire({
            title: 'Are you sure?',
            text: "You won't be able to revert this!",
            icon: 'warning',
            showCancelButton: true,
            confirmButtonColor: '#3085d6',
            cancelButtonColor: '#d33',
            confirmButtonText: 'Yes, delete it!'
        }).then((result) => {
            if (result.isConfirmed) {
                // If confirmed, proceed with the deletion
                window.location.href = element.href;
            }
        });
    }
</script>
